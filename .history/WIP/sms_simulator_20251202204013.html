<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SMS Simulator</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
    body {
        margin: 0;
        font-family: Arial, sans-serif;
        background: rgba(0,0,0,0.85);
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100vh;
        padding: 20px;
    }

    .phone-container {
        width: 340px;
        height: 640px;
        background: #1a1a1a;
        border-radius: 36px;
        padding: 14px;
        box-shadow: 0 20px 60px rgba(0,0,0,0.9);
        display: flex;
        flex-direction: column;
        position: relative;
        border: 8px solid #2a2a2a;
    }

    .notch {
        width: 140px;
        height: 28px;
        background: #000;
        border-radius: 14px;
        margin: 0 auto 8px auto;
        position: relative;
    }

    .camera {
        width: 10px;
        height: 10px;
        background: #0a3d62;
        border-radius: 50%;
        position: absolute;
        top: 9px;
        left: 20px;
    }

    .screen {
        flex: 1;
        background: #000;
        border-radius: 24px;
        overflow: hidden;
        display: flex;
        flex-direction: column;
    }

    .status-bar {
        background: #1c1c1c;
        padding: 8px 16px;
        display: flex;
        justify-content: space-between;
        font-size: 13px;
        color: #fff;
        font-weight: 500;
    }

    .message-header {
        background: #2c2c2c;
        padding: 16px;
        color: #fff;
        border-bottom: 1px solid #3a3a3a;
    }

    .sender {
        font-size: 18px;
        font-weight: bold;
        margin-bottom: 4px;
    }

    .subtitle {
        font-size: 12px;
        color: #999;
    }

    .message-body {
        flex: 1;
        background: #000;
        padding: 20px;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
        gap: 12px;
    }

    .message-bubble {
        background: #1c1c1c;
        padding: 14px 16px;
        border-radius: 18px;
        max-width: 85%;
        color: #fff;
        font-size: 15px;
        line-height: 1.5;
        animation: slideIn 0.3s ease;
        box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }

    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateY(10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .timestamp {
        font-size: 11px;
        color: #666;
        margin-top: 6px;
        text-align: right;
    }

    .action-bar {
        background: #1c1c1c;
        padding: 16px;
        display: flex;
        gap: 12px;
        border-top: 1px solid #3a3a3a;
    }

    .btn {
        flex: 1;
        padding: 12px;
        border: none;
        border-radius: 10px;
        font-size: 15px;
        font-weight: bold;
        cursor: pointer;
        transition: 0.2s;
    }

    .btn-close {
        background: #444;
        color: #fff;
    }

    .btn-close:hover {
        background: #555;
    }

    .btn-log {
        background: #0ea5e9;
        color: #fff;
    }

    .btn-log:hover {
        background: #0284c7;
    }

    .delivery-status {
        font-size: 11px;
        color: #0ea5e9;
        text-align: center;
        margin-top: 8px;
        animation: fadeIn 0.5s ease;
    }

    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }

    .highlight {
        color: #0ea5e9;
        font-weight: bold;
    }
</style>
</head>
<body>

<div class="phone-container">
    <div class="notch">
        <div class="camera"></div>
    </div>
    
    <div class="screen">
        <div class="status-bar">
            <span> 5G</span>
            <span id="time">--:--</span>
            <span>100% </span>
        </div>

        <div class="message-header">
            <div class="sender" id="sender">DCS Logistics</div>
            <div class="subtitle">Automated Message</div>
        </div>

        <div class="message-body" id="messageBody">
            <!-- Messages will be injected here -->
        </div>

        <div class="delivery-status" id="deliveryStatus"></div>

        <div class="action-bar">
            <button class="btn btn-close" onclick="closeSim()">Close</button>
            <button class="btn btn-log" onclick="viewLog()">SMS Log</button>
        </div>
    </div>
</div>

<script>
// Message templates
const MESSAGES = {
    check_in: {
        title: "Check-In Confirmation",
        content: `Welcome to DCS!

You have been successfully checked in at the Gatehouse.

Your mobile number: <span class="highlight">{phone}</span>

Please keep your phone nearby  we will contact you when it's time to proceed.

Reference: <span class="highlight">{po}</span>
Estimated wait: <span class="highlight">{quoted} minutes</span>

Thank you for your patience.`
    },
    
    notified: {
        title: "Loading Bay Ready",
        content: `<span class="highlight">ACTION REQUIRED</span>

Please proceed immediately to the loading area.

Bay Assignment: <span class="highlight">TBC on arrival</span>

Ensure your paperwork is ready and follow instructions from Goods-Out staff.

Reference: <span class="highlight">{po}</span>

Thank you.`
    },
    
    released: {
        title: "Departure Confirmation",
        content: `Loading Complete

You may now proceed to the gatehouse exit.

Please ensure you have all documentation before leaving.

Reference: <span class="highlight">{po}</span>
Total time on site: <span class="highlight">{duration}</span>

Safe travels!`
    }
};

// Get message type from URL parameter
const params = new URLSearchParams(window.location.search);
const messageType = params.get('type') || 'check_in';
const vehicleData = {
    phone: params.get('phone') || '+44 7XXX XXXXXX',
    po: params.get('po') || 'PO-12345',
    quoted: params.get('quoted') || '60',
    duration: params.get('duration') || '45 mins'
};

// Update time
function updateTime() {
    const now = new Date();
    document.getElementById('time').textContent = 
        now.toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit' });
}
updateTime();
setInterval(updateTime, 1000);

// Load message
function loadMessage() {
    const template = MESSAGES[messageType];
    if (!template) return;

    let content = template.content;
    
    // Replace placeholders
    Object.keys(vehicleData).forEach(key => {
        content = content.replace(`{${key}}`, vehicleData[key]);
    });

    const messageBody = document.getElementById('messageBody');
    messageBody.innerHTML = `
        <div class="message-bubble">
            ${content}
            <div class="timestamp">${new Date().toLocaleTimeString('en-GB', { 
                hour: '2-digit', 
                minute: '2-digit' 
            })}</div>
        </div>
    `;

    // Show delivery status
    setTimeout(() => {
        document.getElementById('deliveryStatus').textContent = ' Delivered';
    }, 800);

    // Log to localStorage
    logSMS(messageType, vehicleData);
}

// Log SMS to localStorage
function logSMS(type, data) {
    const log = JSON.parse(localStorage.getItem('sms_log') || '[]');
    log.unshift({
        type,
        data,
        timestamp: new Date().toISOString(),
        sender: 'DCS Logistics'
    });
    
    // Keep last 50 messages
    if (log.length > 50) log.length = 50;
    
    localStorage.setItem('sms_log', JSON.stringify(log));
}

// View SMS log
function viewLog() {
    window.open('sms_log.html', '_blank', 'width=400,height=600');
}

// Close simulator
function closeSim() {
    window.close();
}

// Initialize
loadMessage();
</script>

</body>
</html>
